---
data: 2023.01.24
alias: []
tags: math
symbol:
page:
---
## Теорема о нижней оценке для сортировки сравнениями
Любому алгоритму сортировки сравнениями можно сопоставить дерево. В нем узлам соответствуют операции сравнения элементов, ребрам — переходы между состояниями алгоритма, а листьям — конечные перестановки элементов (соответствующие завершению алгоритма сортировки). Необходимо доказать, что высота такого дерева для любого алгоритма сортировки сравнениями не меньше чем $\Omega(n\log n)$ , где $n$ - количество элементов. 

Ограничимся рассмотрением сортировки перестановок $n$ элементов. При сравнении некоторых двух из них, существует два возможных исхода $(a_{i} \leq a_{j}$ и $a_{i} \geq a_{j} )$ , значит, каждый узел дерева имеет не более двух сыновей. Всего существует $n!$ различных перестановок $n$ элементов, значит, число листьев нашего дерева не менее $n!$ (в противном случае некоторые перестановки были бы не достижимы из корня, а, значит, алгоритм не правильно работал бы на некоторых исходных данных).

Докажем, что двоичное дерево с не менее чем $n!$ листьями имеет глубину $\Omega(n\log n)$ . Легко показать, что двоичное дерево высоты $h$ имеет не более чем $2^{h}$ листьев. Значит, имеем неравенство $n! \leq l \leq 2^{h}$, где $l$ - число листьев. Прологарифмировав его, получим:
$$
h\geq \log_{2}n! = \log_{2}1+\log_{2}2+\dots+\log_{2}n\gt \frac{n}{2}\log_{2}(\frac{n}{2})=\frac{n}{2}(\log_{2}n-1)=\Omega(n\log n)
$$
Итак, для любого алгоритма сортировки сравнениями, существует такая перестановка, на которой он выполнит $\Omega(n\log n)$ сравнений.